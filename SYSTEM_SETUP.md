# åä¾¨åŸ-æ™ºæ…§ç¤¾åŒºæŠ•ç¥¨ç«™ - ç³»ç»Ÿåˆå§‹åŒ–å®Œæˆ

## âœ… å®Œæˆçš„å·¥ä½œ

### 1. åˆå§‹åŒ–æµ‹è¯•æ•°æ®è„šæœ¬
- **æ–‡ä»¶**: `backend/init_test_data.js`
- **åŠŸèƒ½**: ç”Ÿæˆå®Œæ•´çš„æµ‹è¯•æ•°æ®åŒ…æ‹¬ï¼š
  - 3ä¸ªæ¥¼æ ‹ç®¡ç†å‘˜
  - 15ä¸ªå·²æ‰¹å‡†ä¸šä¸»
  - 5ä¸ªå¾…å®¡æ ¸ä¸šä¸»
  - 6ä¸ªæŠ•ç¥¨è¯é¢˜ï¼ˆä¸åŒçŠ¶æ€ï¼‰
  - è¯é¢˜é€‰é¡¹å’ŒæŠ•ç¥¨æ•°æ®

### 2. æ¸…ç©ºæ•°æ®è„šæœ¬
- **æ–‡ä»¶**: `backend/clear_data.js`
- **åŠŸèƒ½**: æ¸…é™¤æ‰€æœ‰æ•°æ®ï¼Œä»…ä¿ç•™è¶…çº§ç®¡ç†å‘˜è´¦å·
- **æ‰§è¡Œå‘½ä»¤**: `node clear_data.js`

### 3. åˆ é™¤ä¸šä¸»åŠŸèƒ½
- **åç«¯API**: `DELETE /api/admin/residents/:id`
- **å‰ç«¯UI**: å·²æ·»åŠ "åˆ é™¤"æŒ‰é’®åœ¨ç®¡ç†åå°
- **æƒé™**: ä»…è¶…çº§ç®¡ç†å‘˜å¯æ“ä½œ

### 4. ä¿®å¤å¾…å®¡æ ¸ä¸šä¸»åŠ è½½å¤±è´¥
- **åŸå› **: ç«æ€æ¡ä»¶å¯¼è‡´åˆå§‹åŒ–é¡ºåºé—®é¢˜
- **è§£å†³æ–¹æ¡ˆ**:
  - ä¼˜åŒ–åˆå§‹åŒ–æµç¨‹ï¼Œç¡®ä¿ç”¨æˆ·ä¿¡æ¯å…ˆåŠ è½½
  - æ·»åŠ è‡ªåŠ¨é‡è¯•æœºåˆ¶ï¼ˆæœ€å¤š2æ¬¡ï¼‰
  - æ”¹è¿›é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•

## ğŸ“Š å½“å‰æ•°æ®åº“çŠ¶æ€

```
ä¸šä¸»æ€»æ•°: 1 (ä»…è¶…çº§ç®¡ç†å‘˜)
æŠ•ç¥¨è¯é¢˜: 0
æŠ•ç¥¨è®°å½•: 0
æ¥¼æ ‹ç®¡ç†å‘˜: 0
```

## ğŸ” è¶…çº§ç®¡ç†å‘˜è´¦å·

```
ç”¨æˆ·å: admin
å¯†ç : 895600
ID: 15
çŠ¶æ€: approved
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å¯åŠ¨æœåŠ¡
```bash
# åç«¯ (ç»ˆç«¯1)
cd backend && node server.js

# å‰ç«¯ (ç»ˆç«¯2)
cd frontend && npm start
```

### è®¿é—®ç³»ç»Ÿ
- **å‰ç«¯**: http://localhost:3000
- **åç«¯**: http://localhost:3001
- **APIæ–‡æ¡£**: http://localhost:3001/api/docs

### å¸¸ç”¨å‘½ä»¤

```bash
# ç”Ÿæˆæµ‹è¯•æ•°æ®
cd backend && node init_test_data.js

# æ¸…ç©ºæ•°æ®ï¼ˆä¿ç•™è¶…çº§ç®¡ç†å‘˜ï¼‰
cd backend && node clear_data.js

# æŸ¥çœ‹æ•°æ®åº“çŠ¶æ€
sqlite3 voting.db "SELECT COUNT(*) FROM residents;"
```

## ğŸ“ æµ‹è¯•è´¦å·ï¼ˆå¦‚æœæ‰§è¡Œäº†init_test_data.jsï¼‰

### è¶…çº§ç®¡ç†å‘˜
- ç”¨æˆ·å: `admin`
- å¯†ç : `895600`

### æ¥¼æ ‹ç®¡ç†å‘˜
- `liz` / `password` (T4æ ‹)
- `wangadmin` / `password` (T5æ ‹)
- `zhangadmin` / `password` (T6æ ‹)

### æ™®é€šä¸šä¸»
- `zhang` / `password`
- `li` / `password`
- `wang` / `password`
- ç­‰å…¶ä»–15ä¸ªè´¦æˆ·

### å¾…å®¡æ ¸ä¸šä¸»
- `liu` / `password`
- `song` / `password`
- `tang` / `password`
- ç­‰å…¶ä»–å¾…å®¡æ ¸è´¦æˆ·

## ğŸ”§ ä¸»è¦åŠŸèƒ½

### åç«¯API
- âœ… ç”¨æˆ·æ³¨å†Œ/ç™»å½•
- âœ… æŠ•ç¥¨è®®é¢˜ç®¡ç†
- âœ… ä¸šä¸»å®¡æ ¸ç®¡ç†
- âœ… æ¥¼æ ‹ç®¡ç†å‘˜è®¾ç½®
- âœ… æŠ•ç¥¨åŠŸèƒ½
- âœ… æ•°æ®å¤‡ä»½/æ¢å¤
- âœ… **æ–°å¢**: åˆ é™¤ä¸šä¸»åŠŸèƒ½

### å‰ç«¯åŠŸèƒ½
- âœ… é¦–é¡µï¼ˆæ˜¾ç¤ºæ‰€æœ‰æŠ•ç¥¨è®®é¢˜ï¼‰
- âœ… æŠ•ç¥¨åˆ—è¡¨ï¼ˆå‚ä¸æŠ•ç¥¨ï¼‰
- âœ… ä¸ªäººä¸­å¿ƒï¼ˆä¿®æ”¹å¯†ç ï¼‰
- âœ… ç®¡ç†åå°ï¼ˆä»…è¶…çº§ç®¡ç†å‘˜å’Œæ¥¼æ ‹ç®¡ç†å‘˜ï¼‰
  - å¾…å®¡æ ¸ä¸šä¸»ç®¡ç†
  - å·²æ‰¹å‡†ä¸šä¸»ç®¡ç†
  - æŠ•ç¥¨è®®é¢˜ç®¡ç†
  - æ•°æ®å¤‡ä»½/æ¢å¤
  - **æ–°å¢**: ä¸šä¸»åˆ é™¤åŠŸèƒ½

## ğŸ› å·²ä¿®å¤çš„é—®é¢˜

1. **å¾…å®¡æ ¸ä¸šä¸»åŠ è½½å¤±è´¥** âœ…
   - åŸå› : ç«æ€æ¡ä»¶
   - æ–¹æ¡ˆ: ä¼˜åŒ–åˆå§‹åŒ–æµç¨‹ï¼Œæ·»åŠ é‡è¯•æœºåˆ¶

2. **æƒé™é—®é¢˜** âœ…
   - æ™®é€šä¸šä¸»ä¸å†çœ‹åˆ°ç®¡ç†åå°èœå•
   - ä½¿ç”¨username-basedè¶…çº§ç®¡ç†å‘˜æ£€æŸ¥

3. **ç™»å½•é—®é¢˜** âœ…
   - ç¡®ä¿åªæœ‰approvedçŠ¶æ€çš„ä¸šä¸»èƒ½ç™»å½•

## ğŸ“± ç³»ç»Ÿæ¶æ„

```
frontend (React + Ant Design)
  â”œâ”€â”€ pages/
  â”‚   â”œâ”€â”€ Home (é¦–é¡µ)
  â”‚   â”œâ”€â”€ Topics (æŠ•ç¥¨åˆ—è¡¨)
  â”‚   â”œâ”€â”€ Login (ç™»å½•)
  â”‚   â”œâ”€â”€ Register (æ³¨å†Œ)
  â”‚   â”œâ”€â”€ Profile (ä¸ªäººä¸­å¿ƒ)
  â”‚   â””â”€â”€ AdminDashboard (ç®¡ç†åå°)
  â””â”€â”€ api/
      â”œâ”€â”€ auth (è®¤è¯)
      â”œâ”€â”€ voting (æŠ•ç¥¨)
      â””â”€â”€ admin (ç®¡ç†å‘˜API)

backend (Express + SQLite)
  â”œâ”€â”€ Routes/
  â”‚   â”œâ”€â”€ /api/auth/* (è®¤è¯)
  â”‚   â”œâ”€â”€ /api/topics/* (æŠ•ç¥¨è®®é¢˜)
  â”‚   â”œâ”€â”€ /api/votes/* (æŠ•ç¥¨)
  â”‚   â”œâ”€â”€ /api/admin/* (ç®¡ç†å‘˜)
  â”‚   â””â”€â”€ /api/stats/* (ç»Ÿè®¡)
  â””â”€â”€ Database/
      â”œâ”€â”€ residents (ä¸šä¸»)
      â”œâ”€â”€ topics (æŠ•ç¥¨è®®é¢˜)
      â”œâ”€â”€ options (æŠ•ç¥¨é€‰é¡¹)
      â”œâ”€â”€ votes (æŠ•ç¥¨è®°å½•)
      â””â”€â”€ building_admins (æ¥¼æ ‹ç®¡ç†å‘˜)
```

## ğŸ“‹ æ•°æ®åº“è¡¨ç»“æ„

### residents (ä¸šä¸»è¡¨)
- id: ä¸»é”®
- username: ç”¨æˆ·å(å”¯ä¸€)
- password: å¯†ç (åŠ å¯†)
- real_name: çœŸå®å§“å
- building: æ¥¼æ ‹
- unit_number: å•å…ƒå·
- phone: ç”µè¯
- status: çŠ¶æ€(pending/approved/rejected)
- is_building_admin: æ˜¯å¦ä¸ºæ¥¼æ ‹ç®¡ç†å‘˜
- managed_building: ç®¡ç†çš„æ¥¼æ ‹
- created_at: åˆ›å»ºæ—¶é—´

### topics (æŠ•ç¥¨è®®é¢˜è¡¨)
- id: ä¸»é”®
- title: æ ‡é¢˜
- description: æè¿°
- status: çŠ¶æ€(pending/active/closed)
- created_by: åˆ›å»ºè€…
- sort_order: æ’åºé¡ºåº
- created_at: åˆ›å»ºæ—¶é—´

### options (æŠ•ç¥¨é€‰é¡¹è¡¨)
- id: ä¸»é”®
- topic_id: æ‰€å±è®®é¢˜
- option_text: é€‰é¡¹æ–‡æœ¬
- votes: æŠ•ç¥¨æ•°
- created_at: åˆ›å»ºæ—¶é—´

### votes (æŠ•ç¥¨è®°å½•è¡¨)
- id: ä¸»é”®
- topic_id: è®®é¢˜ID
- resident_id: ä¸šä¸»ID
- option_id: é€‰é¡¹ID
- created_at: åˆ›å»ºæ—¶é—´
- å”¯ä¸€çº¦æŸ: (topic_id, resident_id) - é˜²æ­¢é‡å¤æŠ•ç¥¨

## ğŸ”’ å®‰å…¨ç‰¹æ€§

- âœ… JWT Tokenè®¤è¯ (24å°æ—¶è¿‡æœŸ)
- âœ… å¯†ç BCryptåŠ å¯†
- âœ… CORSè·¨åŸŸä¿æŠ¤
- âœ… æƒé™æ£€æŸ¥(è¶…çº§ç®¡ç†å‘˜/æ¥¼æ ‹ç®¡ç†å‘˜/æ™®é€šä¸šä¸»)
- âœ… SQLé˜²æ³¨å…¥(å‚æ•°åŒ–æŸ¥è¯¢)
- âœ… ä¸šä¸»æ•°æ®éšç§ä¿æŠ¤

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

- âœ… æ•°æ®åº“ç´¢å¼•ä¼˜åŒ–
- âœ… APIå“åº”å‹ç¼©
- âœ… å‰ç«¯ç¼“å­˜ç­–ç•¥
- âœ… å¼‚æ­¥å¹¶è¡ŒåŠ è½½

## ğŸ› ï¸ æ•…éšœæ’é™¤

### åç«¯æ— æ³•å¯åŠ¨
```bash
# æ£€æŸ¥3001ç«¯å£æ˜¯å¦è¢«å ç”¨
lsof -ti:3001

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
node server.js 2>&1 | head -50
```

### å‰ç«¯æ— æ³•åŠ è½½
```bash
# æ¸…é™¤ç¼“å­˜å¹¶é‡æ–°å¯åŠ¨
rm -rf node_modules/.cache
npm start
```

### æ•°æ®åº“æŸå
```bash
# é‡æ–°åˆå§‹åŒ–ï¼ˆä»…ä¿ç•™è¶…çº§ç®¡ç†å‘˜ï¼‰
node clear_data.js

# æˆ–ç”Ÿæˆæ–°çš„æµ‹è¯•æ•°æ®
node init_test_data.js
```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

- åç«¯æ—¥å¿—: `/tmp/backend.log`
- å‰ç«¯æ—¥å¿—: `/tmp/frontend.log`
- æ•°æ®åº“: `./backend/voting.db`

---

**ç³»ç»ŸçŠ¶æ€**: âœ… æ­£å¸¸è¿è¡Œ  
**æœ€åæ›´æ–°**: 2025å¹´12æœˆ2æ—¥  
**ç‰ˆæœ¬**: 1.1.0
